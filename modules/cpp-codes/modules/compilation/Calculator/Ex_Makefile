# Directories.
SRC_DIR := src
INCLUDE_DIR := include
BUILD_DIR := build

# Compiler and flags.
CC := g++
CPPFLAGS := -I$(INCLUDE_DIR)

# Get source files (*.cpp) using wildcard function.
SRC_FILES := $(wildcard $(SRC_DIR)/*.cpp)

# Preprocessed files
PREPROCESSED_FILES := $(patsubst $(SRC_DIR)/%.cpp,$(BUILD_DIR)/%.i,$(SRC_FILES))

# Default target
all: $(PREPROCESSED_FILES)

# Rule to create the build directory
$(BUILD_DIR):
	mkdir -p $(BUILD_DIR)

# Rule to preprocess source files
$(BUILD_DIR)/%.i: $(SRC_DIR)/%.cpp | $(BUILD_DIR)
	$(CC) -E $(CPPFLAGS) $< -o $@

# Phony target to clean generated files
clean:
	rm -rfv $(BUILD_DIR)

# Phony target to clean and rebuild
rebuild: clean all

# Ignore built-in rules and variables
.SUFFIXES:

.PHONY: all clean rebuild
